# 感情分析アプリケーション

キーログデータから感情を分析するアプリケーションです。HMM（隠れマルコフモデル）を使用して、キー入力パターンから感情状態を推定します。

## 機能

- **CSVデータ読み込み**: キーログデータのCSVファイルを読み込み
- **感情分析**: HMMモデルを使用した感情推定
- **統計情報**: 感情分布、変化回数などの統計分析
- **結果保存**: 分析結果をCSVファイルに出力
- **GUI**: 使いやすいグラフィカルユーザーインターフェース

## 必要なファイル

### メインアプリケーション
- `mizuki2025/emotion_analyzer_app.py` - メインアプリケーション

### HMMモデルファイル
- `HMMleran/hmm_emotion_model_4states.pkl` - 訓練済みHMMモデル
- `HMMleran/hmm_emotion_model_4states_states.pkl` - 状態名マッピング

### サンプルデータ
- `keydata/keylog_output.csv` - サンプルキーログデータ
- `mizuki2025/mizuki2025output.csv` - サンプル出力データ

## インストール

1. 必要なライブラリをインストール:
```bash
pip install -r requirements.txt
```

2. conda環境を使用する場合:
```bash
conda activate keyst
pip install -r requirements.txt
```

## 使用方法

### アプリケーションの起動

```bash
cd /Users/sakumasin/Documents/GitHub/kenkyu
source /opt/anaconda3/bin/activate keyst  # conda環境の場合
python mizuki2025/emotion_analyzer_app.py
```

### 使用手順

1. **CSV読み込み**: 「CSV読み込み」ボタンをクリックしてキーログデータを読み込み
2. **感情分析**: 「感情分析実行」ボタンをクリックして分析を実行
3. **結果確認**: 「感情分析結果」タブで分析結果を確認
4. **統計情報**: 「統計情報」タブで詳細な統計を確認
5. **結果保存**: 「分析結果保存」ボタンで結果をCSVファイルに保存

## 入力データ形式

CSVファイルには以下の列が必要です：

- `キー情報`: 押されたキーの情報
- `持続時間(s)`: キーが押されていた時間（秒）
- `遅延時間(s)`: 前のキーからの遅延時間（秒）
- `経過時間(s) (セッション開始からの時間)`: セッション開始からの経過時間（秒）

## 感情ラベル

アプリケーションは以下の4つの感情状態を識別します：

1. **感覚運動的興奮** - 活発で興奮した状態
2. **難解・頭脳型** - 集中して思考している状態
3. **和みと癒し** - リラックスした状態
4. **設定状況の魅力** - 特定の状況に魅了された状態

## 技術仕様

- **言語**: Python 3.8+
- **GUI**: Tkinter
- **機械学習**: scikit-learn, hmmlearn
- **データ処理**: pandas, numpy
- **モデル**: HMM（隠れマルコフモデル）

## 注意事項

- このアプリケーションは権限問題を回避するため、リアルタイムキーロガー機能は含まれていません
- 分析には事前に訓練されたHMMモデルが必要です
- macOSのアクセシビリティ権限は不要です

## トラブルシューティング

### アプリケーションが起動しない場合
- Python環境とライブラリのインストールを確認
- HMMモデルファイルの存在を確認

### 分析結果が表示されない場合
- 入力データの形式を確認
- HMMモデルファイルの整合性を確認

## ライセンス

このプロジェクトは研究目的で作成されています。